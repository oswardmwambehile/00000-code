{% extends "users/base.html" %}
{% load static %}
{% load humanize %}

{% block content %}
{% include "users/sidebar.html" %}

<div class="main-panel">
  <div class="main-header">
    {% include "users/nav.html" %}
  </div>

  <div class="container">
    <div class="page-inner mt-4">

      <h3 class="mb-3">
        <i class="fas fa-clipboard-list text-primary me-2"></i>All Sales
      </h3>

      <!-- Filter by Created Date (optional) -->
      <form method="get" class="row g-3 mb-4 align-items-end">
        <div class="col-md-4">
          <label class="form-label">Created Date</label>
          <input type="date" name="created_date" class="form-control" value="{{ created_date }}">
        </div>
        <div class="col-md-8 d-flex flex-wrap gap-2">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-filter me-1"></i> Filter
          </button>
          <a href="" class="btn btn-secondary">
            <i class="fas fa-undo me-1"></i> Reset
          </a>
          <a href="" class="btn btn-success">
            <i class="fas fa-plus me-1"></i> New Sale
          </a>
          <a href="{% url 'add_visit' %}" class="btn btn-dark">
            <i class="fas fa-home me-1"></i> Home
          </a>
        </div>
      </form>

      <!-- Sales Table -->
      {% if sales %}
      <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle w-100 custom-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Company Name</th>
          
              <th>Status</th>
           
              <th>Created At</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for sale in sales %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td>{{ sale.company.company_name }}</td>
              
              <td>
                <span class="badge 
                  {% if sale.status == 'Open' %}bg-info
                  {% elif sale.status == 'Won Paid' %}bg-success
                  {% elif sale.status == 'Won Pending Payment' %}bg-warning text-dark
                  {% elif sale.status == 'Lost' %}bg-danger
                  {% else %}bg-light text-dark{% endif %}">
                  {{ sale.status }}
                </span>
              </td>
             
              <td>{{ sale.created_at|date:"Y-m-d H:i" }}</td>
              <td class="text-nowrap"></td>
  <!-- View Details -->
   <td>
  <a href="{% url 'sales_detail' sale.id %}" class="btn btn-sm btn-primary me-1 mb-1">
    <i class="fas fa-eye"></i> View Detail
</a>

  </a>
  
</td>


            </tr>
            {% empty %}
            <tr>
              <td colspan="7" class="text-center text-muted">No sales found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
     
      {% else %}
        <p class="text-muted">No sales found.</p>
      {% endif %}

    </div>
  </div>
</div>

<!-- Styling -->
<style>
  .custom-table td, .custom-table th { white-space: nowrap; vertical-align: middle; padding: 8px 12px; }
  .custom-table thead th { background: none !important; font-weight: 600; border-bottom: 2px solid #ccc; }
  .badge { font-size: 0.85rem; }
  @media (max-width: 768px){
    .table-responsive { overflow-x: auto; }
    .custom-table td, .custom-table th { font-size: 0.875rem; }
    .btn { flex: 1 1 auto; text-align: center; }
  }
</style>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

{% endblock %}



